<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>HH Towers • Digital Directory</title>

    <!-- <link
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap"
      rel="stylesheet"
    /> -->

    <style>
      body {
        font-family: "Poppins", sans-serif;
        background: #f9f9f9;
        margin: 0;
        padding: 16px;
        color: #222;
      }

      #header {
        position: sticky;
        top: 0;
        background: #f9f9f9;
        z-index: 1000;
        padding: 12px 16px;
        box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
        margin-bottom: 12px;
      }

      h1 {
        font-size: 20px;
        font-weight: 600;
        margin-bottom: 4px;
      }

      .search-instruction {
        font-size: 13px;
        color: #777;
        margin-bottom: 10px;
      }

      input[type="text"] {
        width: 100%;
        padding: 12px;
        font-size: 15px;
        border: 1px solid #ccc;
        border-radius: 10px;
        margin-bottom: 20px;
        box-sizing: border-box;
      }

      .floor-section {
        margin-bottom: 10px;
        border-bottom: 1px solid #eee;
        padding-bottom: 16px;
      }

      .floor-title {
        font-weight: 600;
        font-size: 16px;
        margin-bottom: 12px;
        color: #333;
      }

      .shop-grid {
        display: flex;
        flex-wrap: wrap;
        gap: 12px;
      }

      .shop-card {
        flex: 0 0 32%;
        box-sizing: border-box;
        padding: 14px;
        border-radius: 12px;
        background: #efcff8;
        color: #000;
        box-shadow: 0 3px 6px rgba(0, 0, 0, 0.05);
        transition: transform 0.15s ease;
        cursor: pointer;
        min-height: 100px;
      }

      .shop-card:hover {
        transform: scale(1.03);
      }

      .shop-card.vacant {
        background: #cff8f1;
        color: #666;
        font-style: italic;
      }

      .shop-no {
        font-weight: bold;
        font-size: 14px;
      }

      .tenant-name {
        font-size: 13px;
        line-height: 1.2;
        overflow: hidden;
        display: -webkit-box;
        -webkit-line-clamp: 3; /* For Safari, old Edge, Chrome */
        -webkit-box-orient: vertical;

        line-clamp: 3; /* Standard property */
        box-orient: vertical;
      }

      /* Popup styles */
      #popupOverlay {
        position: fixed;
        inset: 0;
        background: rgba(0, 0, 0, 0.6);
        display: none;
        align-items: center;
        justify-content: center;
        z-index: 9999;
        animation: fadeIn 0.2s ease-in;
      }

      #popupCard {
        background: white;
        padding: 24px;
        border-radius: 14px;
        width: 90%;
        max-width: 340px;
        box-shadow: 0 6px 16px rgba(0, 0, 0, 0.15);
        animation: scaleIn 0.2s ease;
        margin-left: 10px;
        margin-right: 10px;
      }

      #popupCard h3 {
        margin-top: 0;
        margin-bottom: 12px;
        font-size: 18px;
        font-weight: 600;
      }

      #popupCard p {
        margin: 6px 0;
        font-size: 14px;
      }

      #popupCard a {
        color: #007bff;
        text-decoration: none;
      }

      #popupCard button {
        margin-top: 15px;
        padding: 10px 16px;
        background: #eaeaea;
        color: rgb(117, 117, 117);
        border: none;
        border-radius: 8px;
        cursor: pointer;
        font-size: 14px;
        transition: background 0.2s ease;
      }

      #popupCard button:hover {
        background: #0056b3;
      }

      /* Animations */
      @keyframes fadeIn {
        from {
          opacity: 0;
        }
        to {
          opacity: 1;
        }
      }

      @keyframes scaleIn {
        from {
          transform: scale(0.95);
        }
        to {
          transform: scale(1);
        }
      }

      /* Responsive tweak */
      @media (max-width: 600px) {
        .shop-card {
          flex: 0 0 48%;
        }
      }
    </style>
  </head>
  <body>
    <div id="header">
      <h1>HH Towers • Digital Directory</h1>
      <div class="search-instruction">
        Search shop name, floor, or shop number below
      </div>
      <input
        type="text"
        id="searchInput"
        placeholder="Type to search..."
        oninput="renderDirectory()"
      />
    </div>

    <div id="directory"></div>

    <div id="popupOverlay" style="display: none">
      <div id="popupCard">
        <h3 id="popupBusiness"></h3>
        <p><strong>Shop No:</strong> <span id="popupShopNo"></span></p>
        <p><strong>Contact:</strong> <span id="popupContact"></span></p>
        <p>
          <strong>Phone:</strong>
          <a id="popupPhone" href="#" target="_blank"></a>
        </p>
        <p>
          <strong>Email:</strong>
          <a id="popupEmail" href="#" target="_blank"></a>
        </p>
        <button onclick="closePopup()">Close</button>
      </div>
    </div>

    <script>
      const data = {
        building: "HH Towers",
        floors: [
          {
            name: "Basement (B1)",
            code: "B1",
            shops: [
              {
                shop_no: "B1-01",
                tenant: {
                  business_name: "House of Contemporary African Urban & Streetwear Design Studio",
                  contact_name: "Grace Mwangi",
                  phone: null,
                  email: "grace@tittysxpah.co.ke",
                },
              },
              {
                shop_no: "B1-02",
                tenant: {
                  business_name: "The Perfume Spot",
                  contact_name: "David Otieno",
                  phone: "+254700112233",
                  email: "info@perfumespot.co.ke",
                },
              },
            ],
          },
          {
            name: "Ground Floor (G)",
            code: "G",
            shops: [
              {
                shop_no: "G-01",
                tenant: {
                  business_name: "Body by Fresh",
                  contact_name: "Cynthia Nduta",
                  phone: "+254701234567",
                  email: "support@bodybyfresh.com",
                },
              },
              {
                shop_no: "G-02",
                tenant: null,
              },
            ],
          },
          {
            name: "First Floor (F1)",
            code: "F1",
            shops: [
              {
                shop_no: "F1-01",
                tenant: {
                  business_name: "Fresh by Glory",
                  contact_name: "Glory Njenga",
                  phone: "+254799887766",
                  email: "glory@freshbyglory.co.ke",
                },
              },
              {
                shop_no: "F1-02",
                tenant: {
                  business_name: "Shop of China",
                  contact_name: "Liu Zhang",
                  phone: "+254789123456",
                  email: "contact@shopofchina.com",
                },
              },
              {
                shop_no: "F1-03",
                tenant: null,
              },
            ],
          },
        ],
      };

      function renderDirectory() {
        const query = document
          .getElementById("searchInput")
          .value.toLowerCase();
        const container = document.getElementById("directory");
        container.innerHTML = "";

        data.floors.forEach((floor) => {
          const filteredShops = floor.shops.filter((shop) => {
            const shopNo = shop.shop_no.toLowerCase();
            const floorName = floor.name.toLowerCase();

            const tenant = shop.tenant;
            const business = tenant?.business_name.toLowerCase() || "";
            const contact = tenant?.contact_name.toLowerCase() || "";
            const phone = tenant?.phone?.toLowerCase() || "";
            const email = tenant?.email?.toLowerCase() || "";

            return (
              shopNo.includes(query) ||
              floorName.includes(query) ||
              business.includes(query) ||
              contact.includes(query) ||
              phone.includes(query) ||
              email.includes(query)
            );
          });

          if (filteredShops.length > 0) {
            const floorSection = document.createElement("div");
            floorSection.className = "floor-section";

            const floorTitle = document.createElement("div");
            floorTitle.className = "floor-title";
            floorTitle.textContent = floor.name;
            floorSection.appendChild(floorTitle);

            const grid = document.createElement("div");
            grid.className = "shop-grid";

            filteredShops.forEach((shop) => {
              const shopCard = document.createElement("div");
              shopCard.className =
                "shop-card" + (shop.tenant === null ? " vacant" : "");

              shopCard.innerHTML = `
                <div class="shop-no">${shop.shop_no}</div>
                <div class="tenant-name">${
                  shop.tenant ? shop.tenant.business_name : "Vacant"
                }</div>
                `;

              shopCard.addEventListener("click", () => showPopup(shop));

              grid.appendChild(shopCard);
            });

            floorSection.appendChild(grid);

            container.appendChild(floorSection);
          }
        });
      }

      // First render
      renderDirectory();

      function showPopup(shop) {
        const overlay = document.getElementById("popupOverlay");
        const business = document.getElementById("popupBusiness");
        const shopNo = document.getElementById("popupShopNo");
        const contact = document.getElementById("popupContact");
        const phone = document.getElementById("popupPhone");
        const email = document.getElementById("popupEmail");

        const phoneEl = document.getElementById("popupPhone");
        const emailEl = document.getElementById("popupEmail");

        if (!shop.tenant) {
          business.innerText = "Vacant Shop";
          shopNo.innerText = shop.shop_no;
          contact.innerText = "Contact Management - John";

          phoneEl.innerText = phoneEl.href =
            "tel:" + (shop.tenant ? shop.tenant.phone : "+254715823592");
          emailEl.innerText = emailEl.href =
            "mailto:" +
            (shop.tenant ? shop.tenant.email : "john@nwrealite.co.ke");

          phone.innerText = "0715 823 592"; // your management number
          email.innerText = "john@nwrealite.co.ke";
        } else {
          business.innerText = shop.tenant.business_name;
          shopNo.innerText = shop.shop_no;
          contact.innerText = shop.tenant.contact_name;

          const phone = shop.tenant.phone?.trim();
          const email = shop.tenant.email?.trim();

          if (phone) {
            phoneEl.innerText = phone;
            phoneEl.href = "tel:" + phone;
          } else {
            phoneEl.innerText = "Not available";
            phoneEl.removeAttribute("href");
          }

          if (email) {
            emailEl.innerText = email;
            emailEl.href = "mailto:" + email;
          } else {
            emailEl.innerText = "Not available";
            emailEl.removeAttribute("href");
          }
        }

        overlay.style.display = "flex";
      }

      function closePopup() {
        document.getElementById("popupOverlay").style.display = "none";
      }

      window.addEventListener("load", () => {
        const link = document.createElement("link");
        link.href =
          "https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap";
        link.rel = "stylesheet";
        document.head.appendChild(link);
      });
    </script>
  </body>
</html>
